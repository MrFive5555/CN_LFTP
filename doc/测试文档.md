# LFTP性能测试
## 测试环境
在下面的前若干项测试中，我们仅使用本地的服务器和客户端作为测试环境，以提供更加受控的测试环境。仅在最后一个实验中，我们才测试传输系统在真实Internet之中的传输性能。　　
在本地的测试环境中，我们暂时修改客户端的代码，在接受到数据包之后，放入一个模拟测试环境的函数中，在这个中间函数中，我们可以精确模拟网络中丢包，乱序等网络行为。从而考察程序在这些环境下的行为。
## 测试方法
**样本文件**:我们将生成一个用于作传输样本的，大小为10M的测试文件。
**传输曲线**:作出传输过程中时间－已传输数据量的折线图，直观地表现程序在传输过程中的行为。
## 测试设计
针对LFTP所需要完成的各项功能，我们设计了下面的传输环境：
### 无阻塞网络传输
测试用户发送和接受功能是否正确实现。
### 模拟拥塞网络
模拟一个有随机时延，并且报文段到达顺序无法保证，有可能丢包的网络。
### 多用户同时传输
多个用户同时传输，在曲线图上观察多个用户传输过程是否有并发。并且检测几个用户是否都收到正确的数据。
### 真实因特网环境测试
在Internet的环境下，多个用户同时向服务器请求一部电影，检查几个用户是否能成功接受电影并顺利播放。
## 测试结果
### 理想网络传输
![](https://github.com/MrFive5555/CN_LFTP/blob/master/doc/result_pic/ideal%20network.png?raw=true)  
在理想网络环境下传输时，文件几乎是匀速传输
### 模拟拥塞网络
![](https://github.com/MrFive5555/CN_LFTP/blob/master/doc/result_pic/simulated%20network.png?raw=true)  
在模拟的拥塞网络下，传输曲线表现出了更复杂的形状，在传输过程中会有速度的变化，但总体没有与理想情况下的直线形状偏差太多（因为模拟网络中的时延有一个固定的均值）。而当我们靠近一点看的时候，可以看见曲线上有一些不光滑的凹凸，这些是出现较大时延或丢包时出现时的波动。
### 多用户同时传输
![](https://github.com/MrFive5555/CN_LFTP/blob/master/doc/result_pic/multiClient.png?raw=true)  
这里我们让三个用户同时向服务器请求文件，可以看见，三者之间没有一个会全部占用网络带宽，服务器可以较公平地处理这三个连接的传输请求。
### 真实因特网环境测试